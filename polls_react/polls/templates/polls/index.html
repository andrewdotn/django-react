{% load static %}

{% load argonauts %}

<h1>New style</h1>

<div id=pollsContent></div>

<script src="{% static 'react.js' %}"></script>
<script src="{% static 'react-dom.js' %}"></script>
<script src="{% static 'browser.min.js' %}"></script>
<script src="{% static 'jquery.min.js' %}"></script>
<script type="text/babel">
    var pollsData = {{ polls_data|json }};

    var ChoiceRow = React.createClass({
        render: function() {
            return (
                    <tr>
                        <td>{ this.props.data.votes }</td>
                        <td>{ this.props.data.choice_text }</td>
                    </tr>
            );
        }
    });

    var Question = React.createClass({
        render: function() {
            var answerNodes = this.props.data.choice_set.map(function(choice) {
                return <ChoiceRow data={choice} key={choice.url}/>
            });
            return (<li>
                { this.props.data.question_text }
                <table>
                    <thead>
                    <tr><th>Votes</th><th>Choice</th></tr>
                    </thead>
                    <tbody>
                    { answerNodes }
                    </tbody>
                </table>
                </li>);
        }
    });

    var PollBox = React.createClass({
        render: function() {
            var questionNodes = this.props.data.map(function(question) {
                return (<Question data={question} key={question.url}/>);
            });
            return (
                    <ul>{ questionNodes }</ul>
            );
        }
    });

    ReactDOM.render(
            <PollBox data={pollsData}/>,
            document.getElementById('pollsContent')
    );
</script>

<h1>Old style</h1>

{% if latest_question_list %}
    <ul>
    {% for question in latest_question_list %}
        <li><a href="{% url 'polls:detail' question.id %}"
            >{{ question.question_text }}</a></li>
    {% endfor %}
    </ul>
{% else %}
    <p>No polls are available.</p>
{% endif %}
